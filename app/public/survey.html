<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <title>Friend Finder</title>
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jquery-confirm/3.3.0/jquery-confirm.min.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.3/umd/popper.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-confirm/3.3.0/jquery-confirm.min.js"></script>
</head>

<body>
  <div class="container">
    <div class="jumbotron">
      <h1 class="text-center">
        <span class="glyphicon glyphicon-sunglasses"></span> Friend Finder</h1>
      <hr>
      <h2 class="text-center">Find friends with similar interests!</h2>
      <br>
      <div class="text-center">
        <a href="/">
          <button class="btn btn-lg btn-default">
            <span class="glyphicon glyphicon-home"></span>
          </button>
        </a>

        <!-- <a href="/friends">
          <button class="btn btn-lg btn-primary">
            <span class="glyphicon glyphicon-user"></span> View Friends</button>
        </a> -->
      </div>
    </div>
    <div class="col12">
      <h2 class="text-center">Survey Questions</h2>
      <hr>

      <h3>
        <strong>About You</strong>
      </h3>
      <h4>Name (Required)</h4>
      <input type="text" id="name" class="form-control" required="">
      <h4>Link to Photo (Required)</h4>
      <input type="text" id="photo" class="form-control" required="">
      <hr>
      <form id="question-form">
        <div class="form-group">
          <h3>
            <strong>Question 1</strong>
          </h3>
          <h4>You'd rather hang out in a small group setting vs a large one</h4>
          <select class="form-control" id="ques1">
            <option value="">Select an Option</option>
            <option value="1">1 (Strongly Disagree)</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5 (Strongly Agree)</option>
          </select>
        </div>
        <div class="form-group">
          <h3>
            <strong>Question 2</strong>
          </h3>
          <h4>You'd rather make new friends vs keeping the same company</h4>
          <select class="form-control" id="ques2">
            <option value="">Select an Option</option>
            <option value="1">1 (Strongly Disagree)</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5 (Strongly Agree)</option>
          </select>
        </div>
        <div class="form-group">
          <h3>
            <strong>Question 3</strong>
          </h3>
          <h4>You'd rather eat out vs bringing food home</h4>
          <select class="form-control" id="ques3">
            <option value="">Select an Option</option>
            <option value="1">1 (Strongly Disagree)</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5 (Strongly Agree)</option>
          </select>
        </div>
        <div class="form-group">
          <h3>
            <strong>Question 4</strong>
          </h3>
          <h4>At a party youd be dancing vs looking at your phone</h4>
          <select class="form-control" id="ques4">
            <option value="">Select an Option</option>
            <option value="1">1 (Strongly Disagree)</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5 (Strongly Agree)</option>
          </select>
        </div>
        <div class="form-group">
          <h3>
            <strong>Question 5</strong>
          </h3>
          <h4>You'd rather stay home and watch TV vs going out</h4>
          <select class="form-control" id="ques5">
            <option value="">Select an Option</option>
            <option value="1">1 (Strongly Disagree)</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5 (Strongly Agree)</option>
          </select>
        </div>
        <div class="form-group">
          <h3>
            <strong>Question 6</strong>
          </h3>
          <h4>You dont say much during a class lecture</h4>
          <select class="form-control" id="ques6">
            <option value="">Select an Option</option>
            <option value="1">1 (Strongly Disagree)</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5 (Strongly Agree)</option>
          </select>
        </div>
        <div class="form-group">
          <h3>
            <strong>Question 7</strong>
          </h3>
          <h4>You like spending lots of time with family</h4>
          <select class="form-control" id="ques7">
            <option value="">Select an Option</option>
            <option value="1">1 (Strongly Disagree)</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5 (Strongly Agree)</option>
          </select>
        </div>
        <div class="form-group">
          <h3>
            <strong>Question 8</strong>
          </h3>
          <h4>You can make friends easily</h4>
          <select class="form-control" id="ques8">
            <option value="">Select an Option</option>
            <option value="1">1 (Strongly Disagree)</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5 (Strongly Agree)</option>
          </select>
        </div>
        <div class="form-group">
          <h3>
            <strong>Question 9</strong>
          </h3>
          <h4>You'd rather listen to vinyl vs CD</h4>
          <select class="form-control" id="ques9">
            <option value="">Select an Option</option>
            <option value="1">1 (Strongly Disagree)</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5 (Strongly Agree)</option>
          </select>
        </div>
        <div class="form-group">
          <h3>
            <strong>Question 10</strong>
          </h3>
          <h4>You'd rather live in a small town vs a city</h4>
          <select class="form-control" id="ques10">
            <option value="">Select an Option</option>
            <option value="1">1 (Strongly Disagree)</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5 (Strongly Agree)</option>
          </select>
        </div>
        <button type="submit" class="btn btn-primary submit">Submit</button>
      </form>
    </div>
    <footer class="footer">
      <div class="container">
        <p>
          <a href="/api/friends">API Friends Link</a> |
          <a href="https://github.com/christopher-watson/friend-finder" target="_blank">GitHub Repo</a>
        </p>
      </div>
    </footer>
  </div>


  <script type="text/javascript">
    function clearFields() {
      $("#name").val("");
      $("#photo").val("");
      $("#ques1").val("");
      $("#ques2").val("");
      $("#ques3").val("");
      $("#ques4").val("");
      $("#ques5").val("");
      $("#ques6").val("");
      $("#ques7").val("");
      $("#ques8").val("");
      $("#ques9").val("");
      $("#ques10").val("");
    };

    function findBestMatch() {
      var match = {
        name: "",
        photo: "",
        friendDifference: 500
      };

      var friendData = newFriend;
      var friendScores = newFriend.scores;
      var totalDifference;

      for (var i = 0; i < friends.length; i++) {
        var currentFriend = friends[i];
        totalDifference = 0;

        console.log(currentFriend.name);

        for (var j = 0; j < currentFriend.scores.length; j++) {
          var currentFriendScore = currentFriend.scores[j];
          var newFriendScore = newfriendScores[j];

          totalDifference += Math.abs(parseInt(currentFriendScore) - parseInt(newFriendScore));
        }

        if (totalDifference <= bestMatch.friendDifference) {
          bestMatch.name = currentFriend.name;
          bestMatch.photo = currentFriend.photo;
          bestMatch.friendDifference = totalDifference;
        }
      }

      // friends.push(friendData);
      // res.json(bestMatch);
      $.confirm({
        backgroundDismiss: true, // this will just close the modal
        title: 'Found a Friend!',
        content: `${bestMatch.name } + ${bestMatch.photo}`
      });
    };
    $(".submit").on("click", function (event) {
      event.preventDefault();

      var newFriend = {
        name: $("#name").val().trim(),
        photo: $("#photo").val().trim(),
        scores: [
          $("#ques1").val(),
          $("#ques2").val(),
          $("#ques3").val(),
          $("#ques4").val(),
          $("#ques5").val(),
          $("#ques6").val(),
          $("#ques7").val(),
          $("#ques8").val(),
          $("#ques9").val(),
          $("#ques10").val()
        ]
      };

      console.log(newFriend);
      findBestMatch();
      clearFields();
      $.post("/api/friends", newFriend, function (data) {

      });
    });
  </script>
</body>

</html>